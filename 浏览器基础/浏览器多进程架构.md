# 浏览器的多进程架构

# 进程

+ Browser进程：也就是浏览器进程，浏览器的主进程，负责协调主控
+ 插件进程：每种插件对应一个进程，会在使用插件时创建
+ GPU进程：最多一个，用于3D绘制
+ 渲染进程：每个Tab页一个进程，互不影响，控制页面渲染，脚本执行，事件处理等等（有时候同站的网页共用一个进程）
+ 网络进程

# 多进程的优点

+ 避免页面渲染影响到整个浏览器（浏览器进程和渲染进程）
+ 避免插件影响到浏览器（浏览器进程和插件进程）
+ 充分利用多核的优势
+ 方便使用沙盒模型隔离插件等进程，提高浏览器等稳定性

### 渲染进程的多线程

#### GUI线程

> 负责渲染浏览器界面HTML元素，当页面需要重绘或回流时，执行该线程
>
> 在JavaScript引擎运行脚本期间，GUI渲染线程都是处于挂起状态

#### JavaScript引擎线程

> JS 内核，负责处理JS脚本程序，例如V8引擎
>
> 解析JS脚本，运行代码

**JS的单线程**

> 多线程会导致UI操作的冲突

**GUI渲染线程与JS引擎线程互斥**

> 因为JS是可操作DOM的，如果在修改元素属性同时渲染页面，会导致数据的不一致

**JS阻塞页面加载**

> 由于GUI渲染线程与JS引擎线程互斥，当浏览器执行JS程序时，GUI渲染线程会被保存在一个队列中，知道JS

#### 定时器触发线程

> 浏览器定时计数器并不是由JS引擎计数，因为SJ时单线程的，如果处于阻塞线程状态，会影响计时的准确，因此通过单独线程来计时并触发计时时更合理的

#### 事件触发线程

> 当一个事件被触发时，该线程会把事件添加到待处理队列的队尾，等待JS引擎的处理。这些事件可以是当前执行的代码块如定时任务、也可来自浏览器内核的其他线程如鼠标点击、AJAX异步请求等，但因为JS是单线程，因此都需要排队等待处理

#### 异步HTTP请求线程

> 在XHR连接后通过浏览器新开一个线程请求，将检测到状态变更时，如果设置有回调函数，异步线程就将该事件放到处理队列中等待处理





























