# 深拷贝和浅拷贝

### 深拷贝

> JSON.parse和JSON.stringify
>
> + 不能复制正则、function、Symbol
> + 循环引用报错
> + 相同的引用会被重复复制：指向同一个对象的属性会被重复创建

```javascript
let obj = {         
    reg : /^asd$/,
    fun: function(){},
    syb:Symbol('foo'),
    asd:'asd'
}; 
let cp = JSON.parse(JSON.stringify(obj));
```

> 递归属性

```javascript
const deepClone=function(obj){
    const types={
        'date':Date,
        'regexp':RegExp
    };
    if(obj===null || typeof obj!=='object') return obj;
    for(let key in types)
        if(obj instanceof types[key])
            return new types[key]();
    let cloneObj=new obj.constructor();
    for(let key in obj)
        if(obj.hasOwnProperty(key))
            cloneObj[key]=deepClone(obj[key]);
    return cloneObj;
}
```

> lodash
>
> _.cloneDeep

```javascript
const _=require('lodash');
const obj1 = {
    a: 1,
    b: { f: { g: 1 } },
    c: [1, 2, 3]
};
const obj2 = _.cloneDeep(obj1);
console.log(obj1.b.f === obj2.b.f);// false
```

### 浅拷贝

> Object.assign()
>
> 可以把任意多个源对象的可枚举属性拷贝到目标对象然后返回

```javascript
let obj1 = { person: {name: "kobe", age: 41},sports:'basketball' };
let obj2 = Object.assign({}, obj1);
obj2.person.name = "wade";
obj2.sports = 'football'
console.log(obj1); // { person: { name: 'wade', age: 41 }, sports: 'basketball' }
```

> lodash
>
> _.clone

```javascript
var _ = require('lodash');
var obj1 = {
    a: 1,
    b: { f: { g: 1 } },
    c: [1, 2, 3]
};
var obj2 = _.clone(obj1);
console.log(obj1.b.f === obj2.b.f);// true
```

> 展开运算符

```javascript
let obj1 = { name: 'Kobe', address:{x:100,y:100}}
let obj2= {... obj1}
obj1.address.x = 200;
obj1.name = 'wade'
console.log('obj2',obj2) // obj2 { name: 'Kobe', address: { x: 200, y: 100 } }
```

> Array.prototype.concat

```javascript
let arr = [1, 3, {
    username: 'kobe'
    }];
let arr2 = arr.concat();    
arr2[2].username = 'wade';
console.log(arr); //[ 1, 3, { username: 'wade' } ]
```

> Array.prototype.slice

```javascript
let arr = [1, 3, {
    username: ' kobe'
    }];
let arr3 = arr.slice();
arr3[2].username = 'wade'
console.log(arr); // [ 1, 3, { username: 'wade' } ]
```

























