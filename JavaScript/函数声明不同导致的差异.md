# 函数的声明

### 表达式声明

```javascript
var a=function(){
  
}
```

### 直接声明

```javascript
function a(){
  
}
```

### 差别

> + var虽然会对变量a进行提升，但是并不会提升表达式，实际提升的部分只有var a;，因此此时a为undefined
>
>   初次之外，在非严格模式下，var声明的变量会被挂到window对象上，因此window.a===a
>
> + 非严格模式下，直接声明的函数也会被挂到window对象上

```javascript
/**
	* 
*/
a();// a is not a function
var a = function () {};

window.a===a;// true

/**
	* 
*/
a();// 不会报错
function a(){
  
}
window.a===a;// true
```

### JavaScript预解析

> JavaScript解析过程分为两个阶段，分别是编译阶段和执行阶段

#### 编译阶段

> 编译阶段就是JavaScript的预解析阶段，解释器会将JavaScript脚本转为字节码

**变量提升**

> 创建一个当前执行环境下的活动对象AO，将var声明的变量挂到AO上并赋值为undefined，同时将function定义的函数也添加到AO中

```javascript
if(true){
  var a=1;
  var b=2;
}

function A1(){

}

function B1(){
  
}
```

**函数声明与函数表达式在预解析阶段的区别**

> 解析器会对function定义的函数在代码开始执行之前对实行函数进行变量提升，所以函数声明前调用函数不会在执行期间报错，
>
> 但是函数表达式使用var声明，解析器会对其进行变量提升，并赋值为undefined，然后执行期间，将变量指向一个function，因此在指向之前调用会报错

**function覆盖**

> 若定义两个同名函数，在预解析期间后面会覆盖前面

```javascript
AA();   // 输出 I am AA_2;
function AA(){
   console.log('I am AA_1');
};

AA();  // 输出 I am AA_2;
function AA(){
  console.log('I am AA_2');
}
```

**预解析把变量或函数解析道其运行时对环境中**

> 解析器将变量提升到执行环境对应的AO中，并不一定是window

**预解析分段进行**

> 按照script标签分块预解析

#### 执行阶段

> 借助执行环境把字节码转为机器码，并按顺序执行

### Q&A

```javascript
AA(); // 输出 AA_2

function AA(){
  console.log(' AA_2 ');
}

var AA = function(){
  console.log(' AA_1 ');
}

AA(); //输出 AA_1
```

> 首先，会将var的声明和function声明向上提，因此此时AA指向AA_2
>
> 然后开始向下执行，调用输出AA_2
>
> 然后找到表达式声明，指向AA_1，再次调用，输出AA_1































